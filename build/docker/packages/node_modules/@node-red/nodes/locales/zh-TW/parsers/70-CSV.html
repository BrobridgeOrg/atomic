<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/html" data-help-name="csv">
    <p>在 CSV 格式字串和其 JavaScript 物件表示之間進行轉換。</p>
    <h3>輸入</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | array | string</span></dt>
        <dd>一個 JavaScript 物件、陣列或 CSV 字串。</dd>
    </dl>
    <h3>輸出</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | array | string</span></dt>
        <dd>
        <ul>
            <li>如果輸入是一個字串，它會嘗試將其解析為 CSV，並為每行創建一個 key/value 對的 JavaScript 物件。
                節點將為每行發送一條消息，或者發送一條包含陣列物件的訊息。</li>
            <li>如果輸入是一個 JavaScript 對象，它會嘗試構建一個 CSV 字串。</li>
            <li>如果輸入是一個簡單值的陣列，它會構建一個單行 CSV 字串。</li>
            <li>如果輸入是一個陣列的陣列，或者一個物件陣列，則會創建多行 CSV 字串。</li>
        </ul>
        </dd>
    </dl>
    <h3>詳細</h3>
    <p>列模板可以包含一個有序的列名列表。將 CSV 轉換為物件時，列名將用作屬性名稱。或者，列名可以從 CSV 的第一行中獲取。
        <p>當選擇 RFC 解析器時，列模板必須符合 RFC4180。</p>
    </p>
    <p>將對象轉換為 CSV 時，列模板用於確定從對象中提取哪些屬性以及按什麼順序提取。</p>
    <p>如果列模板為空，則可以使用 <code>msg.columns</code> 中提供的簡單逗號分隔的屬性列表來確定提取內容及順序。如果兩者都不存在，則所有對象屬性將按照在第一行中找到的順序輸出。</p>
    <p>如果輸入是一個陣列，則列模板僅用於選擇性地生成一行列標題。</p>
    <p>如果選擇“解析數值”選項，則字串數值將以數字形式返回，即中間值 '1,"1.5",2'。</p>
    <p>如果選擇“包含空字串”選項，則空字串將在結果中返回，即中間值 '"1","",3'。</p>
    <p>如果選擇“包含空值”選項，則空值將在結果中返回，即中間值 '"1",,3'。</p>
    <p>只要 <code>parts</code> 屬性設置正確，該節點可以接受多個 part 輸入，例如來自 file-in 節點或 split 節點。</p>
    <p>如果輸出多條消息，它們將設置其 <code>parts</code> 屬性並形成完整的消息序列。</p>
    <p>如果該節點設置為僅發送一次列標題，則將 <code>msg.reset</code> 設置為任何值將導致節點重新發送標題。</p>
    <p><b>注意：</b> 列模板必須用逗號分隔，即使為數據選擇了不同的分隔符。</p>
    <p><b>注意：</b> 在 RFC 模式下，對於格式錯誤的 CSV 標題和無效的輸入 payload 數據，將拋出可捕獲的錯誤。</p>
</script>
